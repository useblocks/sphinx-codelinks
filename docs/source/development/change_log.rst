.. _changelog:

Changelog
=========

.. _`unreleased`:

Unreleased
-----------

New and Improved
................

- ‚ú® Added RST directive parser for ``analyse`` module to resolve the marked RST into Sphinx-Needs related data.

  Marked RST blocks can be resolved from the marked RST text in source files using the simplified RST directive parser.
  The resolved RST blocks will be dumped into the JSON output along with other extracted markers.
  To make the parser more stable, 3 new configuration options are added to control the parsing behavior:

  - ``strip_leading_sequences``: List of leading character sequences to strip from each line.

    This option allows users to specify a list of leading character sequences (e.g., ``*``, ``-``) that should be stripped
    from each line of the marked RST block before parsing.
    This is useful for handling comment styles that include leading characters in multi-line comments.

  - ``indented_spaces``: Number of spaces that indicate an indented block.
  - ``link_options``: List of option names whose values should be converted to lists when parsed.

- ‚ú® Enhanced the ``src-trace`` directive to support creating need items from marked RST blocks in addition to one-line need definitions.

  The ``src-trace`` directive can now create Sphinx-Needs need items from both one-line need definitions and marked RST blocks.
  This provides more flexibility for defining needs in source code comments.

:Released: 02.10.2025

.. _`release:1.1.0`:

1.1.0
-----

:Released: 02.10.2025

New and Improved
................

- ‚ú® Added C# parser for ``analyse`` module.

  Need ID references and marked RST blocks can be extracted from C# source files.
  The comments styles supported are:(``//``, ``/* */``, ``///``)

- ‚ú® Added YAML parser for ``analyse`` module.

  Need ID references can be extracted from YAML files.
  The supported comment style is ``#`` as well as inline comment style, e.g. ``key: value # comment``.

- üëå Directive ``src-trace`` itself does not create need items anymore and only generate need items from the one-line need definition in the given source.

  The need item is removed because:

  - It has no use cases so far.
  - It creates extra need items users may not actually want in their documentation
  - It creates errors with some Sphinx-Needs configurations, e.g., when ``need_id_required`` or ``needs_statuses`` is defined.

Fixes
.....

- üêõ Replace absolute path with relative path to fix ``local-url`` not working on the non-local environment
- üêõ Add more file extensions of C/C++ for SourceDiscover

.. _`release:1.0.0`:

1.0.0
-----

:Released: 22.08.2025

New and Improved
................

- ‚ú® Added a new ``analyse`` CLI command and corresponding API.

  The ``analyse`` command parses source files (Python, C/C++) and extracts markers from comments.
  It can extract three types of markers, as documented in the :ref:`analyse <analyse>` section:

  - One-line need definitions
  - Need ID references
  - Marked RST blocks

  The extracted markers and their metadata are saved to a JSON file for further processing.

- ‚ú® Added a new ``write rst`` CLI command.

  The ``write rst`` command writes a reStructuredText file with :external+needs:ref:`needextend <needextend>` directive from the extracted markers generated by ``analyse``.
  The generated RST can be included in the Sphinx documentation to create the source code links in the existing needs

- üëå Replaced ``virtual_docs`` with the new ``analyse`` module.

  The ``virtual_docs`` feature, which handled one-line need definitions (:ref:`OneLineCommentStyle <oneline>`),
  has been migrated into the new ``analyse`` module and removed from the core.
  The caching feature of ``virtual_docs`` is temporarily removed and may be reintroduced later.

- üëå Updated the ``src-trace`` Sphinx directive.

  The ``src-trace`` directive now uses the new ``analyse`` API instead of the old ``virtual_docs`` one.

- üëå Unified configuration in TOML

  The configuration for ``src-trace`` directive defined in TOML is now compatible with the new ``analyse`` module.

.. _`release:0.1.2`:

0.1.2
-----

:Released: 16.07.2025

Fixes
.....

- üêõ Apply default configuration values when not given

  When a user does not specify certain configuration options, the extension will automatically use predefined default
  values, allowing users to get started quickly without needing to customize every option.
  Users can override these defaults by explicitly providing their own configuration values.

- üêõ Fix local links for multi project configurations

  Local links between docs and one-line need definitions work correctly, when :ref:`src_dir <source_dir>` in multiple
  project configurations point at different locations.

.. _`release:0.1.1`:

0.1.1
-----

:Released: 11.07.2025

Initial release of ``Sphinx-CodeLinks``

This version features:

- ‚ú® Sphinx Directive ``src-trace``
- ‚ú® Virtual Docs and Source Discovery CLI
- ‚ú® One-line comment to define a ``Sphinx-Needs`` need item
